import{u as P,j as I,k as m,d as $,r as a,o as A,K as D,A as U,b as F,c as G,e as r,C as j,L as T,n as M,x as W,y as z,z as E,_ as L}from"./index-NzSs_JIL.js";const v=P(),O=I("games",{state:()=>({gamesScore:null}),getters:{},actions:{async setUserHP(s){const n=await m.post("https://taptaptap.coinclicker.app/setMatchHP",{hp:s},{headers:{"x-api-key":v.getAccessToken}});return console.log(n),!!n.data.sucess},async getGamesScore(){const s=await m.get("https://taptaptap.coinclicker.app/gamesLeaderBoard",{headers:{"x-api-key":v.getAccessToken}});return console.log(s),this.gamesScore=s.data,s.data},async setUserScore(s){const n=await m.post("https://taptaptap.coinclicker.app/setUserScore",{damage:s},{headers:{"x-api-key":v.getAccessToken}});return console.log(n),!!n.data.sucess},async updateUserHealthDefens(s){const n=await m.post("https://taptaptap.coinclicker.app/setDefensHP",{hp:s},{headers:{"x-api-key":v.getAccessToken}});return console.log(n),!!n.data.sucess}}}),y=s=>(z("data-v-cb818690"),s=s(),E(),s),R=["width","height"],V={id:"unity-loading-bar"},K=y(()=>r("div",{id:"unity-logo"},null,-1)),Q={id:"unity-progress-bar-empty"},q=y(()=>r("div",{id:"unity-webgl-logo"},null,-1)),J=y(()=>r("div",{id:"unity-build-title"},"FlappyDick",-1)),X=$({__name:"GameFight",setup(s){const n=O(),l=P(),f=a("unity-desktop"),w=a(960),_=a(600),k=a("0%"),g=a(!0),b=a(0),S=a(null),u=a(null),d=a(null),p="https://taptaptap.coinclicker.app/uploads/BuildBirds",C=`${p}/buildes.loader.js`,H={dataUrl:`${p}/buildes.data`,frameworkUrl:`${p}/buildes.framework.js`,codeUrl:`${p}/buildes.wasm`,streamingAssetsUrl:`${p}/UnityServicesProjectConfiguration.json`,companyName:"DefaultCompany",productName:"FlappyDick",productVersion:"0.1",showBanner:(e,o)=>{if(d.value){const t=document.createElement("div");t.innerHTML=e,d.value.appendChild(t),o==="error"?t.style.background="red":o==="warning"&&(t.style.background="yellow"),t.style.padding="10px",setTimeout(()=>{d.value&&d.value.removeChild(t)},5e3)}}},B=e=>{k.value=`${100*e}%`,e==1&&console.log("load Finish")},x=()=>{var e;(e=u.value)==null||e.SetFullscreen(1)};A(async()=>{var o,t;if(((o=l.user)==null?void 0:o.id)!=null&&(b.value=(t=l.user)==null?void 0:t.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const i=document.createElement("meta");i.name="viewport",i.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(i),f.value="unity-mobile",w.value=window.innerWidth,_.value=window.innerHeight}g.value=!0;const e=document.createElement("script");e.src=C,e.onload=async()=>{try{u.value=await createUnityInstance(S.value,H,B),g.value=!1}catch(i){alert(i)}},document.body.appendChild(e)}),D(()=>{u.value&&u.value.Quit().then(()=>{u.value=null})});const c=a({userHP:0,userName:"",enemyHP:0,enemyName:""}),h=a(0);return window.SetPlayerHP=function(e){if(l.user){if(console.log(e),l.user.balance<e){U().showAlert("Недостаточный баланс, нужно 100 🐥");return}n.setUserHP(e).then(o=>{l.user&&(l.user.balance-=e,c.value.userHP=e,o&&n.getGamesScore().then(t=>{if(c.value.userName="Bazil",console.log(t),t!=null&&t.length>0){let i=t.findIndex(N=>N.ID==b.value);i==0||i==-1?(c.value.enemyHP=100,c.value.enemyName="Computer",h.value=-1):(c.value.enemyHP=100,c.value.enemyName=t[i-1].UserName,h.value=t[i-1].UserID)}else c.value.enemyHP=100,c.value.enemyName="Computer",h.value=-1;u.value.SendMessage("LoadingWindow(Clone)","OnLoadGame")}))})}},window.SetWinner=function(e){console.log(e),n.setUserScore(Number(e)).then(o=>{console.log(o)})},window.CheckDucksForNextFight=function(){l.user&&(l.user.balance<100&&U().showAlert("Недостаточный баланс, нужно 100 🐥"),u.value.SendMessage("ResultWindow(Clone)","OnRestartGame"))},(e,o)=>(F(),G("div",{id:"unity-container",class:W(f.value)},[r("canvas",{id:"unity-canvas",ref_key:"canvas",ref:S,width:w.value,height:_.value,tabindex:"-1"},null,8,R),j(r("div",V,[K,r("div",Q,[r("div",{id:"unity-progress-bar-full",style:M({width:k.value})},null,4)])],512),[[T,g.value]]),r("div",{id:"unity-warning",ref_key:"warningBanner",ref:d},null,512),r("div",{id:"unity-footer"},[q,r("div",{id:"unity-fullscreen-button",onClick:x}),J])],2))}}),Y=L(X,[["__scopeId","data-v-cb818690"]]),ee=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{Y as G,ee as a,O as u};
