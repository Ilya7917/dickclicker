import{d as se,u as ve,B as Pe,r as h,C as we,b as i,c as a,e,t as u,n as te,f as g,m as d,F as R,_ as ne,v as A,z as ge,A as me,l as Ie,o as De,q as Te,g as de,p as K,h as pe,x as M,H as Se,G as W,I as fe,y as S}from"./index-B_c0kwA_.js";import{A as $e,P as Ae,B as Ve}from"./back-icon-BgRy0Fa2.js";const Ne="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%20width='200'%20height='200'%20style='shape-rendering:%20auto;%20display:%20block;'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cg%20transform='translate(80,50)'%3e%3cg%20transform='rotate(0)'%3e%3ccircle%20fill-opacity='1'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.875s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.875s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(71.21320343559643,71.21320343559643)'%3e%3cg%20transform='rotate(45)'%3e%3ccircle%20fill-opacity='0.875'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.75s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.75s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(50,80)'%3e%3cg%20transform='rotate(90)'%3e%3ccircle%20fill-opacity='0.75'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.625s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.625s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(28.786796564403577,71.21320343559643)'%3e%3cg%20transform='rotate(135)'%3e%3ccircle%20fill-opacity='0.625'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.5s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.5s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(20,50.00000000000001)'%3e%3cg%20transform='rotate(180)'%3e%3ccircle%20fill-opacity='0.5'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.375s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.375s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(28.78679656440357,28.786796564403577)'%3e%3cg%20transform='rotate(225)'%3e%3ccircle%20fill-opacity='0.375'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.25s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.25s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(49.99999999999999,20)'%3e%3cg%20transform='rotate(270)'%3e%3ccircle%20fill-opacity='0.25'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.125s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.125s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(71.21320343559643,28.78679656440357)'%3e%3cg%20transform='rotate(315)'%3e%3ccircle%20fill-opacity='0.125'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='0s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='0s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/g%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io%20--%3e%3c/svg%3e",je="/assets/acceptet-BiKVjkxi.svg",Be={class:"balance-panel"},Le={class:"balance-hint"},Me={class:"balance__wrapper"},Ue={key:0,style:{display:"flex",justifyContent:"center"}},ze=se({__name:"DonateBalance",props:{popupState:{type:Function}},setup(I){var _;const s=ve(),f=I,b=Pe(()=>{var k,D;const r=((D=(k=s.user)==null?void 0:k.posts_balance)==null?void 0:D.toString().length)||0;return r<5?"44px":r<8?"39px":r<12?"34px":r<15?"29px":"24px"}),w=h(((_=s.user)==null?void 0:_.posts_balance)||0);function T(r){const k=w.value,D=r-k;let H=900;D<=10&&(H=300);const q=performance.now();function E(Z){const O=Z-q,U=Math.min(O/H,1);w.value=Math.round(k+D*U),U<1&&requestAnimationFrame(E)}requestAnimationFrame(E)}we(()=>{var r;return((r=s.user)==null?void 0:r.posts_balance)??0},r=>{T(r)},{immediate:!0});const p=()=>{f.popupState("change")};return(r,k)=>{var D;return i(),a(R,null,[e("div",Be,[e("span",Le,u(r.$t("account.yourDonateBalance")),1),e("div",Me,[e("div",{class:"balance",style:te({fontSize:b.value})},u(w.value.toLocaleString()),5)])]),((D=g(s).user)==null?void 0:D.posts_balance)!=null&&g(s).user.posts_balance>0?(i(),a("div",Ue,[e("div",{style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},[e("button",{class:"boost-purchase-button",onClick:p},"Обменять")])])):d("",!0)],64)}}}),Fe=ne(ze,[["__scopeId","data-v-14da8650"]]),Re="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M3%2010C3%206.22876%203%204.34315%204.17157%203.17157C5.34315%202%207.22876%202%2011%202H13C16.7712%202%2018.6569%202%2019.8284%203.17157C21%204.34315%2021%206.22876%2021%2010V14C21%2017.7712%2021%2019.6569%2019.8284%2020.8284C18.6569%2022%2016.7712%2022%2013%2022H11C7.22876%2022%205.34315%2022%204.17157%2020.8284C3%2019.6569%203%2017.7712%203%2014V10ZM6%2012C6%2010.5858%206%209.87868%206.43934%209.43934C6.87868%209%207.58579%209%209%209H15C16.4142%209%2017.1213%209%2017.5607%209.43934C18%209.87868%2018%2010.5858%2018%2012V16C18%2017.4142%2018%2018.1213%2017.5607%2018.5607C17.1213%2019%2016.4142%2019%2015%2019H9C7.58579%2019%206.87868%2019%206.43934%2018.5607C6%2018.1213%206%2017.4142%206%2016V12ZM7%205.25C6.58579%205.25%206.25%205.58579%206.25%206C6.25%206.41421%206.58579%206.75%207%206.75H12C12.4142%206.75%2012.75%206.41421%2012.75%206C12.75%205.58579%2012.4142%205.25%2012%205.25H7Z'%20fill='%231C274C'/%3e%3c/svg%3e",oe=I=>(ge("data-v-40b3c399"),I=I(),me(),I),Oe={class:"navMenu"},We={key:0,style:{width:"100%",display:"flex",justifyContent:"flex-end"}},He={class:"nav-btn__wrapper",style:{marginRight:"30px",display:"flex",flexDirection:"column",gap:"25px"}},Ee={key:0},Ye=oe(()=>e("span",{style:{fontSize:"20px"}},"💎",-1)),Ge=[Ye],Ke={key:1},qe=oe(()=>e("span",{style:{fontSize:"20px"}},"🗓️",-1)),Ze=[qe],Xe=oe(()=>e("span",{style:{fontSize:"20px"}},"🔎",-1)),Je=[Xe],Qe={class:"nav-btn__wrapper"},et=["src"],tt=["src"],st=["src"],nt=["src"],ot={class:"nav-btn__text"},it={key:3,class:"nav-btn__text-item"},at=se({__name:"NavMenu",props:{pageState:{},onFilterPostsBy:{type:Function}},emits:["change-page-state"],setup(I,{emit:s}){const f=I,b=s,w=_=>{_!==f.pageState&&b("change-page-state",_)},T=h(!1),p=_=>{f.onFilterPostsBy(_),T.value=!1};return(_,r)=>(i(),a("div",Oe,[f.pageState=="posts"?(i(),a("div",We,[e("div",He,[T.value?(i(),a("div",Ee,[e("button",{class:"post-component__nav-btn feed",style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:r[0]||(r[0]=k=>p("coin"))},Ge)])):d("",!0),T.value?(i(),a("div",Ke,[e("button",{class:"post-component__nav-btn feed",style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:r[1]||(r[1]=k=>p("date"))},Ze)])):d("",!0),e("div",null,[e("button",{class:"post-component__nav-btn feed",style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:r[2]||(r[2]=()=>{T.value=!T.value})},Je)])])])):d("",!0),e("div",Qe,[f.pageState!="userposts"?(i(),a("button",{key:0,class:A(["post-component__nav-btn feed",{active:f.pageState==="posts"}]),onClick:r[3]||(r[3]=k=>w("posts"))},[e("img",{src:g(Re)},null,8,et)],2)):d("",!0),f.pageState!="userposts"?(i(),a("button",{key:1,class:A(["post-component__nav-btn compose",{active:f.pageState==="create"}]),onClick:r[4]||(r[4]=k=>w("create"))},[e("img",{src:g($e)},null,8,tt)],2)):d("",!0),f.pageState!="userposts"?(i(),a("button",{key:2,class:A(["post-component__nav-btn profile",{active:f.pageState==="myposts"}]),onClick:r[5]||(r[5]=k=>w("myposts"))},[e("img",{src:g(Ae)},null,8,st)],2)):(i(),a("button",{key:3,class:"post-component__nav-btn profile",onClick:r[6]||(r[6]=k=>w("posts"))},[e("img",{src:g(Ve)},null,8,nt)]))]),e("div",ot,[f.pageState!="userposts"?(i(),a("span",{key:0,class:A(["nav-btn__text-item",{active:f.pageState==="posts"}])},"Posts",2)):d("",!0),f.pageState!="userposts"?(i(),a("span",{key:1,class:A(["nav-btn__text-item",{active:f.pageState==="create"}])},"Write",2)):d("",!0),f.pageState!="userposts"?(i(),a("span",{key:2,class:A(["nav-btn__text-item",{active:f.pageState==="myposts"}])},"Profile",2)):(i(),a("span",it,"Back"))])]))}}),lt=ne(at,[["__scopeId","data-v-40b3c399"]]),x=I=>(ge("data-v-8e040d9a"),I=I(),me(),I),ct=x(()=>e("div",{class:"Bg"},null,-1)),rt={key:0,class:"createPostMenu"},ut={id:"progressbar"},dt={class:"createForm"},pt={key:0,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},ft=x(()=>e("span",{style:{fontWeight:"bold",marginTop:"15px"}},"⚠️ Добавить можно только 1 изображение",-1)),vt={class:"sec-center",style:{marginTop:"20px"}},gt=x(()=>e("input",{class:"dropdown",type:"checkbox",id:"dropdown",name:"dropdown"},null,-1)),mt={class:"for-dropdown",for:"dropdown"},_t={class:"section-dropdown"},yt=x(()=>e("i",{class:"uil uil-arrow-right"},"💸",-1)),ht=x(()=>e("i",{class:"uil uil-arrow-right"},"🗳️",-1)),xt={key:1,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},bt=x(()=>e("label",{for:"fname"},"Описание(не обязательно)",-1)),kt={key:2,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},Ct={key:0,style:{display:"flex",alignItems:"center"}},Pt=x(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Платный пост (не обязательно)",-1)),wt={class:"checkbox-wrapper-7",style:{marginLeft:"20px"}},It=x(()=>e("label",{class:"tgl-btn",for:"cb2-7"},null,-1)),Dt={key:1,style:{display:"flex",alignItems:"center",flexDirection:"column"}},Tt=x(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Цена голосования (в 🍆):",-1)),St={key:2,style:{marginTop:"50px",textAlign:"center"}},$t=x(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Цена за разблокировку:",-1)),At=x(()=>e("div",{style:{marginTop:"50px",textAlign:"center"}},[e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Стоимость создания поста: 1000🍆")],-1)),Vt={key:3},Nt={key:0,style:{display:"flex",flexDirection:"column"}},jt=["src"],Bt=x(()=>e("span",{style:{fontSize:"17px",fontWeight:"bold",marginTop:"10px"}},"Подождите, мы загружаем ваш пост...",-1)),Lt={key:1},Mt=["src"],Ut={key:0,style:{display:"flex",justifyContent:"center"}},zt={key:1,class:"boosts"},Ft={class:"post"},Rt={class:"ownerData"},Ot=["src","onClick"],Wt=["onClick"],Ht=["src"],Et={class:"postDescription"},Yt={key:0,class:"unlock",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},Gt={style:{fontSize:"14px"}},Kt=["onClick"],qt={key:1,class:"donations",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},Zt={class:"donation__counter"},Xt=["onClick"],Jt={key:2},Qt={class:"vote__counter"},es={class:"vote__counter-actions"},ts={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},ss={style:{fontSize:"18px"}},ns=["onClick"],os={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},is={style:{fontSize:"18px"}},as=["onClick"],ls={style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"15px"}},cs=["onClick"],rs={key:2,class:"boosts"},us={style:{fontSize:"20px",fontWeight:"bold",margin:"0 auto"}},ds={class:"post"},ps={class:"ownerData"},fs=["src"],vs=["src"],gs={class:"postDescription"},ms={key:0,class:"unlock",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},_s={style:{fontSize:"14px"}},ys=["onClick"],hs={key:1,class:"donations",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},xs={class:"donation__counter"},bs=["onClick"],ks={key:2},Cs={class:"vote__counter"},Ps={class:"vote__counter-actions"},ws={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},Is={style:{fontSize:"18px"}},Ds=["onClick"],Ts={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},Ss={style:{fontSize:"18px"}},$s=["onClick"],As={style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"15px"}},Vs=["onClick"],Ns={class:"popup-content"},js={class:"popup-header"},Bs=x(()=>e("svg",{class:"close-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"16px",height:"16px"},[e("path",{d:"M 7 4 C 6.744125 4 6.4879687 4.0974687 6.2929688 4.2929688 L 4.2929688 6.2929688 C 3.9019687 6.6839688 3.9019687 7.3170313 4.2929688 7.7070312 L 11.585938 15 L 4.2929688 22.292969 C 3.9019687 22.683969 3.9019687 23.317031 4.2929688 23.707031 L 6.2929688 25.707031 C 6.6839688 26.098031 7.3170313 26.098031 7.7070312 25.707031 L 15 18.414062 L 22.292969 25.707031 C 22.682969 26.098031 23.317031 26.098031 23.707031 25.707031 L 25.707031 23.707031 C 26.098031 23.316031 26.098031 22.682969 25.707031 22.292969 L 18.414062 15 L 25.707031 7.7070312 C 26.098031 7.3170312 26.098031 6.6829688 25.707031 6.2929688 L 23.707031 4.2929688 C 23.316031 3.9019687 22.682969 3.9019687 22.292969 4.2929688 L 15 11.585938 L 7.7070312 4.2929688 C 7.5115312 4.0974687 7.255875 4 7 4 z"})],-1)),Ls=[Bs],Ms={key:0,class:"popup-body"},Us=x(()=>e("p",null,"Price:",-1)),zs={key:1,class:"popup-body"},Fs={class:"slidecontainer",style:{marginTop:"30px"}},Rs=["max"],Os={key:2,class:"popup-body"},Ws=x(()=>e("p",null," Не нравится пост? ",-1)),Hs={class:"slidecontainer",style:{marginTop:"30px"}},Es=["max"],Ys={key:3},Gs=["src"],Ks={key:0},qs={key:4},Zs={class:"slidecontainer",style:{marginTop:"30px"}},Xs=["max"],Js={key:3,class:"myPosts"},Qs=["onClick"],en=x(()=>e("div",{class:"icon-box",style:{fontSize:"27px"}},"🌐",-1)),tn={class:"text-container",style:{display:"flex",justifyContent:"center"}},sn={style:{marginLeft:"11px"}},nn=se({__name:"Posts",setup(I){Ie();const s=ve();s.getBoosts(),h(!1),h(!1);const f="https://taptaptap.coinclicker.app",b=h("posts"),w=h(!1);h("");const T=h(!1),p=h({image:null,isPrivate:!1,description:"",type:"",price:0,votePrice:0}),_=h(0),r=[{id:0,isActive:!0,text:"Add image"},{id:1,isActive:!1,text:"Write description"},{id:2,isActive:!1,text:"Choose Details"}],k=o=>{if(s.posts==null)return[];const n=s.posts.filter(c=>c.Type!=="vote").sort((c,v)=>v.Donated-c.Donated),l=s.posts.filter(c=>c.Type==="vote").sort((c,v)=>v.VoteYes+v.VoteNo-(c.VoteYes+c.VoteNo));return[...n,...l]};async function D(){try{await Promise.all([s.getMyBoughtPosts(),s.getPosts().then(o=>{if(o){if(s.posts==null)return;let n=k(s.posts);s.posts=n;const l=s.posts.filter(m=>m.Type==="donate"),c=s.posts.filter(m=>m.Type==="vote"),v=[];for(;l.length>0||c.length>0;){if(l.length>0){const m=l.shift();m!==void 0&&v.push(m)}if(c.length>0){const m=c.shift();m!==void 0&&v.push(m)}}s.posts=v}}),s.getMyPosts()])}catch(o){console.error("Error fetching user data:",o)}}De(()=>{b.value="posts",D()});const H=o=>{o!==b.value&&(b.value=o)},q=o=>{const l=o.target.files;if(l&&l.length>0){const c=l[0],v=new FileReader;v.onload=m=>{var t;const $=new Image;$.onload=()=>{const j=document.createElement("canvas"),P=j.getContext("2d"),Q=1024,ee=1024;let B=$.width,L=$.height;B>L?B>Q&&(L*=Q/B,B=Q):L>ee&&(B*=ee/L,L=ee),j.width=B,j.height=L,P!=null&&P.drawImage($,0,0,B,L),j.toBlob(ue=>{ue&&(p.value.image=new File([ue],c.name,{type:c.type}),T.value=!0)},c.type,.8)},$.src=(t=m.target)==null?void 0:t.result},v.readAsDataURL(c)}},E=o=>{console.log(1);const l=o.target.value;l&&(p.value.description=l),console.log(p)},Z=()=>{_.value!==0&&(T.value=!1),_.value++,r[_.value].isActive=!0},O=h(!1),U=()=>{if(s.user){if(s.user.balance<1e3){S().showAlert("Недостаточно 🍆 для создания поста");return}if(p.value.type!="vote"){if(p.value.price<=0&&p.value.isPrivate){S().showAlert("Стоимость открытия поста не может быть 0 🍆");return}}else if(p.value.votePrice<10){S().showAlert("Стоимость голосования поста не может быть меньше 10 🍆");return}if(p.value.isPrivate=w.value,p.value.image!=null){const o={image:p.value.image,isPrivate:p.value.isPrivate,description:p.value.description,price:p.value.price,type:p.value.type,votePrice:p.value.votePrice};_.value++,s.createPost(o).then(n=>{n&&setTimeout(()=>{_.value=0,b.value="posts",r.forEach(l=>{l.id!==0&&(l.isActive=!1)}),O.value=!0,O.value=!1,s.getPosts(),s.getMyPosts()},2500)})}else S().showAlert("Не выбрано изображение")}},C=h("close"),y=h({id:0,price:0,imagePath:"",decription:"",donated:0}),z=(o,n,l,c,v,m)=>{if(o=="dump"&&s.user!=null&&s.user.balance<1e3){S().showAlert("Недостаточно средств. Минимум 1000 🍆");return}C.value=o,y.value.id=n,y.value.price=l,y.value.imagePath=c!==null?c:"",y.value.decription=v!==null?v:"",y.value.donated=m!==null?m:0},_e=()=>{if(s.user){if(s.user.balance<y.value.price){S().showAlert("Недостаточно средств на счету");return}console.log(y.value.id),s.unlockPost(y.value.id).then(o=>{if(o&&s.posts!=null){let n=s.posts.findIndex(l=>l.ID==y.value.id);n!=-1&&(s.posts[n].IsPrivate=!1,s.getMyBoughtPosts())}})}},ie=(o,n)=>{var l;if(s.user){if(s.posts!=null&&s.posts[s.posts.findIndex(c=>c.ID==o)].Type!="donate"||s.user.id==n||s.posts!=null&&!s.posts[s.posts.findIndex(c=>c.ID==o)].IsPrivate)return!1;if(s.posts!=null&&s.posts[s.posts.findIndex(c=>c.ID==o)].IsPrivate)if(s.boughtPosts!=null){if(s.boughtPosts.length<0)return!0;if(((l=s.boughtPosts)==null?void 0:l.length)>0)return s.boughtPosts.findIndex(c=>c.PostID==o)==-1}else return!0}},ae=(o,n)=>{if(s.user)return s.user.id==o||s.posts!=null&&!s.posts[s.posts.findIndex(l=>l.ID==n)].IsPrivate?!1:o!=s.user.id?!ye(n):!0},ye=o=>{if(s.boughtPosts!=null&&s.boughtPosts.length>0){let n=s.boughtPosts.findIndex(l=>l.PostID==o);if(console.log(n,o),n!=-1)return console.log(n),!0}return!1},V=h(0),he=()=>{if(s.user){if(s.user.balance<Number(V.value)){S().showAlert("Недостаточно средств на счету");return}s.donatePost(y.value.id,V.value).then(o=>{if(o&&s.posts!=null){let n=s.posts.findIndex(l=>l.ID==y.value.id);n!=-1&&(s.posts[n].Donated+=Number(V.value))}})}},xe=o=>{switch(o){case"unlock":return"Unlock post?";case"donate":return"Donate post?";case"visible":return`Post: ${y.value.id}`;case"change":return"Exchange donated dicks for basic ones?";case"dump":return"Dump post?"}},N=h(0),be=()=>{s.user&&(s.user.posts_balance!=null&&s.user.posts_balance<N.value&&S().showAlert("ⓘ Недостаточно средств для вывода!"),S().showAlert("ⓘ Система удерживает 30% комиссию при переводе средств с донатного счёта на основной! ⓘ"),s.exchangeDonateMoney(N.value).then(o=>{var n;o&&((n=s.user)==null?void 0:n.posts_balance)!=null&&(s.user.posts_balance-=N.value)}))},le=o=>{p.value.type=o},ke=o=>{switch(o){case"donate":return"Донатный 💸";case"vote":return"Голосование 🗳️"}return""},Y=(o,n,l)=>{if(s.user){if(s.user.balance<l){S().showAlert("Недостаточно 🍆 для голосования");return}s.votePost(o,n).then(c=>{if(c&&s.posts!=null){let v=s.posts.findIndex(m=>m.ID==o);if(v!=-1)switch(n){case"yes":s.posts[v].VoteYes+=1;break;case"no":s.posts[v].VoteNo+=1;break}}})}},X=o=>{o.target.blur()},G=h(0),J=o=>{s.dumpPost(o,1e3).then(n=>{n&&D()})};let F=h(void 0),ce="";const re=o=>{s.posts&&s.posts.length>0?(F.value=s.posts.filter(n=>n.OwnerID===o),F.value!=null&&F.value&&(b.value="userposts",ce=F.value[0].OwnerName)):F.value=[]},Ce=o=>{if(s.posts!=null)switch(o){case"coin":D();break;case"date":s.posts=s.posts.filter(n=>n.CreatedAt!==null).filter(n=>n.CreatedAt&&new Date(n.CreatedAt).toString()!=="Invalid Date").sort((n,l)=>new Date(l.CreatedAt||new Date).getTime()-new Date(n.CreatedAt||new Date).getTime());break}};return(o,n)=>{var c,v,m,$;const l=Te("click-outside");return i(),a(R,null,[ct,de(lt,{"page-state":b.value,onChangePageState:H,onFilterPostsBy:Ce},null,8,["page-state"]),b.value==="create"?(i(),a("div",rt,[e("div",null,[e("ul",ut,[(i(),a(R,null,K(r,t=>e("li",{class:A(t.isActive?"active":"")},u(t.text),3)),64))])]),e("div",dt,[_.value===0?(i(),a("div",pt,[e("input",{class:"addFile",type:"file",onChange:q},null,32),ft,e("div",vt,[gt,e("label",mt,u(p.value.type==""?"Выберите тип поста":ke(p.value.type)),1),e("div",_t,[e("a",{onClick:n[0]||(n[0]=t=>le("donate"))},[pe("Донатный "),yt]),e("a",{onClick:n[1]||(n[1]=t=>le("vote"))},[pe("Голосование "),ht])])])])):d("",!0),_.value===1?(i(),a("div",xt,[bt,M(e("input",{type:"text",id:"fname",onChange:E,name:"fname"},null,544),[[l,X]])])):d("",!0),_.value===2?(i(),a("div",kt,[p.value.type!="vote"?(i(),a("div",Ct,[Pt,e("div",wt,[M(e("input",{class:"tgl tgl-ios",id:"cb2-7",type:"checkbox","onUpdate:modelValue":n[2]||(n[2]=t=>w.value=t)},null,512),[[Se,w.value]]),It])])):d("",!0),p.value.type=="vote"?(i(),a("div",Dt,[Tt,M(e("input",{type:"number",onKeydown:fe(U,["enter"]),"onUpdate:modelValue":n[3]||(n[3]=t=>p.value.votePrice=t),style:{width:"100%"}},null,544),[[l,X],[W,p.value.votePrice]])])):d("",!0),w.value?(i(),a("div",St,[$t,M(e("input",{type:"number",onKeydown:fe(U,["enter"]),"onUpdate:modelValue":n[4]||(n[4]=t=>p.value.price=t)},null,544),[[l,X],[W,p.value.price]])])):d("",!0),At,e("div",null,[e("button",{class:"mypost-button",style:{marginTop:"30px"},onClick:U},"Создать")])])):d("",!0),_.value===3?(i(),a("div",Vt,[O.value?(i(),a("div",Lt,[e("img",{src:g(je)},null,8,Mt)])):(i(),a("div",Nt,[e("img",{src:g(Ne)},null,8,jt),Bt]))])):d("",!0)]),T.value?(i(),a("div",Ut,[e("button",{class:"mypost-button",style:{marginTop:"30px"},onClick:Z},"Дальше")])):d("",!0)])):d("",!0),b.value==="posts"?(i(),a("div",zt,[(i(!0),a(R,null,K(g(s).posts,(t,j)=>(i(),a("div",{key:t.ID,style:{width:"100%"}},[e("div",Ft,[e("div",Rt,[e("img",{src:t.AvatarURL.includes("uploads")?`${g(f)}/${t.AvatarURL}`:t.AvatarURL,onClick:P=>re(t.OwnerID)},null,8,Ot),e("span",{onClick:P=>re(t.OwnerID)},u(t.OwnerName),9,Wt)]),e("div",{class:"postImage",style:te({filter:ae(t.OwnerID,t.ID)?"blur(25px)":"blur(0px)"})},[e("img",{src:t.ImagePath.includes("uploads")?`${g(f)}/${t.ImagePath}`:t.ImagePath,style:{maxWidth:"100%",height:"auto",width:"100%"}},null,8,Ht)],4),e("div",Et,[e("span",null,u(t.Description),1)]),ie(t.ID,t.OwnerID)?(i(),a("div",Yt,[e("span",Gt,"🍆"+u(t.Price),1),e("button",{class:"boost-purchase-button",onClick:P=>z("unlock",t.ID,t.Price,null,null,null)},"Unlock",8,Kt)])):d("",!0),t.Type!="vote"?(i(),a("div",qt,[e("span",Zt,"Donated: 🍆"+u(t.Donated-t.Dumped),1),e("button",{class:"boost-purchase-button",onClick:P=>z("donate",t.ID,t.Price,null,null,null)},"Donate",8,Xt)])):(i(),a("div",Jt,[e("div",Qt,[e("span",null,"Всего: "+u((t.VoteYes+t.VoteNo)*t.VotePrice-t.Dumped)+"🍆",1)]),e("div",es,[e("div",ts,[e("span",ss,u(t.VoteYes)+" ✅",1),e("button",{class:"boost-purchase-button",style:{marginLeft:"15px",marginTop:"10px",height:"40px",backgroundColor:"#3f8b1e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>Y(t.ID,"yes",t.VotePrice)},"Да "+u(t.VotePrice)+"🍆",9,ns)]),e("div",os,[e("span",is,u(t.VoteNo)+" ❌",1),e("button",{class:"boost-purchase-button",style:{marginRight:"15px",marginTop:"10px",height:"40px",backgroundColor:"#bc0e0e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>Y(t.ID,"no",t.VotePrice)},"Нет "+u(t.VotePrice)+"🍆",9,as)])])])),e("div",ls,[e("button",{class:"boost-purchase-button",style:{padding:"15px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>J(t.ID)},"😡 Dump 1.000 🍆",8,cs)])])]))),128))])):d("",!0),b.value==="userposts"?(i(),a("div",rs,[e("span",us," Посты пользователя: "+u(g(ce)),1),(i(!0),a(R,null,K(g(F),(t,j)=>(i(),a("div",{key:t.ID,style:{width:"100%"}},[e("div",ds,[e("div",ps,[e("img",{src:t.AvatarURL.includes("uploads")?`${g(f)}/${t.AvatarURL}`:t.AvatarURL},null,8,fs),e("span",null,u(t.OwnerName),1)]),e("div",{class:"postImage",style:te({filter:ae(t.OwnerID,t.ID)?"blur(25px)":"blur(0px)"})},[e("img",{src:t.ImagePath.includes("uploads")?`${g(f)}/${t.ImagePath}`:t.ImagePath,style:{maxWidth:"100%",height:"auto",width:"100%"}},null,8,vs)],4),e("div",gs,[e("span",null,u(t.Description),1)]),ie(t.ID,t.OwnerID)?(i(),a("div",ms,[e("span",_s,"🍆"+u(t.Price),1),e("button",{class:"boost-purchase-button",onClick:P=>z("unlock",t.ID,t.Price,null,null,null)},"Unlock",8,ys)])):d("",!0),t.Type!="vote"?(i(),a("div",hs,[e("span",xs,"Donated: 🍆"+u(t.Donated-t.Dumped),1),e("button",{class:"boost-purchase-button",onClick:P=>z("donate",t.ID,t.Price,null,null,null)},"Donate",8,bs)])):(i(),a("div",ks,[e("div",Cs,[e("span",null,"Всего: "+u((t.VoteYes+t.VoteNo)*t.VotePrice-t.Dumped)+"🍆",1)]),e("div",Ps,[e("div",ws,[e("span",Is,u(t.VoteYes)+" ✅",1),e("button",{class:"boost-purchase-button",style:{marginLeft:"15px",marginTop:"10px",height:"40px",backgroundColor:"#3f8b1e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>Y(t.ID,"yes",t.VotePrice)},"Да "+u(t.VotePrice)+"🍆",9,Ds)]),e("div",Ts,[e("span",Ss,u(t.VoteNo)+" ❌",1),e("button",{class:"boost-purchase-button",style:{marginRight:"15px",marginTop:"10px",height:"40px",backgroundColor:"#bc0e0e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>Y(t.ID,"no",t.VotePrice)},"Нет "+u(t.VotePrice)+"🍆",9,$s)])])])),e("div",As,[e("button",{class:"boost-purchase-button",style:{padding:"15px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center"},onClick:P=>J(t.ID)},"😡 Dump 1.000 🍆",8,Vs)])])]))),128))])):d("",!0),e("div",{class:A(["boost-purchase-popup",{visible:C.value=="unlock"||C.value=="donate"||C.value=="visible"||C.value=="change"||C.value=="dump"}]),onClick:n[10]||(n[10]=()=>{C.value="close"})},[e("div",Ns,[e("div",js,[e("h2",null,u(xe(C.value)),1),e("button",{class:"close-button",onClick:n[5]||(n[5]=()=>{C.value="close"})},Ls)]),C.value=="unlock"?(i(),a("div",Ms,[Us,e("p",null,"🍆"+u(y.value.price),1),e("button",{class:"boost-purchase-button",style:{width:"100%"},onClick:_e},"Unlock post")])):d("",!0),C.value=="donate"?(i(),a("div",zs,[e("div",Fs,[M(e("input",{type:"range",min:"0",max:(c=g(s).user)==null?void 0:c.balance,class:"slider",id:"myRange","onUpdate:modelValue":n[6]||(n[6]=t=>V.value=t)},null,8,Rs),[[W,V.value]])]),e("p",null,"🍆"+u(V.value),1),V.value>0?(i(),a("button",{key:0,class:"boost-purchase-button",style:{width:"100%"},onClick:he},"Donate post")):d("",!0)])):d("",!0),C.value=="dump"?(i(),a("div",Os,[Ws,e("div",Hs,[M(e("input",{type:"range",min:"1000",max:(v=g(s).user)==null?void 0:v.balance,step:"1000",class:"slider",id:"myRange","onUpdate:modelValue":n[7]||(n[7]=t=>G.value=t)},null,8,Es),[[W,G.value]])]),e("p",null,"🍆"+u(G.value),1),G.value>=1e3?(i(),a("button",{key:0,class:"boost-purchase-button",style:{width:"100%"},onClick:n[8]||(n[8]=t=>J(y.value.id))},"Dump post")):d("",!0)])):d("",!0),C.value=="visible"?(i(),a("div",Ys,[e("img",{src:y.value.imagePath,style:{height:"200px",width:"100%",backgroundRepeat:"no-repeat",objectFit:"contain"}},null,8,Gs),y.value.decription!==""?(i(),a("p",Ks,u(y.value.decription),1)):d("",!0),e("p",null,"Donated: 🍆"+u(y.value.donated),1)])):d("",!0),C.value=="change"?(i(),a("div",qs,[e("div",Zs,[M(e("input",{type:"range",min:"0",max:((m=g(s).user)==null?void 0:m.posts_balance)!==null?($=g(s).user)==null?void 0:$.posts_balance:0,class:"slider",id:"myRange","onUpdate:modelValue":n[9]||(n[9]=t=>N.value=t)},null,8,Xs),[[W,N.value]])]),e("p",null,"🍆"+u(N.value),1),N.value>0?(i(),a("button",{key:0,class:"boost-purchase-button",style:{width:"100%"},onClick:be},"Exchange")):d("",!0)])):d("",!0)])],2),b.value=="myposts"?(i(),a("div",Js,[de(Fe,{popupState:z}),(i(!0),a(R,null,K(g(s).myPosts,t=>(i(),a("div",{class:"postProfile",onClick:j=>z("visible",t.ID,t.Price,t.ImagePath,t.Description,t.Donated)},[en,e("div",tn,[e("span",sn,"Пост: "+u(t.ID),1)])],8,Qs))),256))])):d("",!0)],64)}}}),ln=ne(nn,[["__scopeId","data-v-8e040d9a"]]);export{ln as default};
