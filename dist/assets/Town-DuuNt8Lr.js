import{d as B,u as N,r as t,z as U,o as F,J as C,b as I,c as M,e as s,B as E,K as O,n as G,v as T,x,y as P,_ as $}from"./index-Da_asuf5.js";import{u as A}from"./games-bg4nowKw.js";const g=d=>(x("data-v-c9cb5e52"),d=d(),P(),d),H=["width","height"],D={id:"unity-loading-bar"},J=g(()=>s("div",{id:"unity-logo"},null,-1)),j={id:"unity-progress-bar-empty"},z=g(()=>s("div",{id:"unity-webgl-logo"},null,-1)),V=g(()=>s("div",{id:"unity-build-title"},"FlappyDick",-1)),W=B({__name:"Town",setup(d){const c=A(),i=N(),m=t("unity-desktop"),h=t(960),p=t(600),y=t("0%"),v=t(!0),w=t(0),f=t(null),a=t(null),r=t(null),u="https://taptaptap.coinclicker.app/uploads/BuildTown",_=`${u}/buildes.loader.js`,S={dataUrl:`${u}/buildes.data`,frameworkUrl:`${u}/buildes.framework.js`,codeUrl:`${u}/buildes.wasm`,streamingAssetsUrl:"",companyName:"DefaultCompany",productName:"FlappyDick",productVersion:"0.1",showBanner:(e,n)=>{if(r.value){const o=document.createElement("div");o.innerHTML=e,r.value.appendChild(o),n==="error"?o.style.background="red":n==="warning"&&(o.style.background="yellow"),o.style.padding="10px",setTimeout(()=>{r.value&&r.value.removeChild(o)},5e3)}}},b=e=>{y.value=`${100*e}%`,e==1&&console.log("load Finish")},k=()=>{var e;(e=a.value)==null||e.SetFullscreen(1)};return window.GetSkins=function(){a.value.SendMessage("GameManager","OnInitSkins",i.skins)},window.GetLastVisit=function(){a.value.SendMessage("FoodSlider","OnSetFoodSlider",JSON.stringify(i.town))},window.GetEnergy=function(){var e,n;a.value.SendMessage("EmojiSlider","OnSetTownEmoji",JSON.stringify({energy:(e=i.user)==null?void 0:e.energy,energy_level:(n=i.user)==null?void 0:n.energy_level}))},window.SaveJSON=function(e){console.log(e),c.saveUserBuildings(e).then(n=>{n&&console.log(n)})},window.GetBuildings=function(){c.getUserBuildings().then(e=>{a.value.SendMessage("GameManager","OnSetBuildings",e)})},window.IncreaseFood=function(e){if(i.user){if(i.user.balance<Number(e)){U().showAlert("Недостаточно коинов 🐥");return}c.onSetFood(Number(e)).then(n=>{if(n){if(!i.user)return;i.user.balance-=Number(e),a.value.SendMessage("FoodSlider","OnAcceptFood")}})}},F(async()=>{var n,o;if(((n=i.user)==null?void 0:n.id)!=null&&(w.value=(o=i.user)==null?void 0:o.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const l=document.createElement("meta");l.name="viewport",l.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(l),m.value="unity-mobile",h.value=window.innerWidth,p.value=window.innerHeight}v.value=!0;const e=document.createElement("script");e.src=_,e.onload=async()=>{try{a.value=await createUnityInstance(f.value,S,b),v.value=!1}catch(l){alert(l)}},document.body.appendChild(e)}),C(()=>{a.value&&a.value.Quit().then(()=>{a.value=null})}),t({userHP:0,userName:"",enemyHP:0,enemyName:""}),t(0),(e,n)=>(I(),M("div",{id:"unity-container",class:T(m.value)},[s("canvas",{id:"unity-canvas",ref_key:"canvas",ref:f,width:h.value,height:p.value,tabindex:"-1"},null,8,H),E(s("div",D,[J,s("div",j,[s("div",{id:"unity-progress-bar-full",style:G({width:y.value})},null,4)])],512),[[O,v.value]]),s("div",{id:"unity-warning",ref_key:"warningBanner",ref:r},null,512),s("div",{id:"unity-footer"},[z,s("div",{id:"unity-fullscreen-button",onClick:k}),V])],2))}}),Q=$(W,[["__scopeId","data-v-c9cb5e52"]]);export{Q as default};
