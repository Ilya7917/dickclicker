import{d as I,u as N,r as o,z as m,o as U,J as G,b as O,c as R,e as i,B as T,K as C,n as F,v as W,x as E,y as A,_ as $}from"./index-BIB6WVNg.js";import{u as x}from"./games-DVwd2V_r.js";const v=u=>(E("data-v-b5523bcb"),u=u(),A(),u),J=["width","height"],H={id:"unity-loading-bar"},P=v(()=>i("div",{id:"unity-logo"},null,-1)),V={id:"unity-progress-bar-empty"},j=v(()=>i("div",{id:"unity-webgl-logo"},null,-1)),z=v(()=>i("div",{id:"unity-build-title"},"FlappyDick",-1)),D="1.0.1",L=I({__name:"Town",setup(u){const l=x(),a=N(),g=o("unity-desktop"),w=o(960),h=o(600),p=o("0%"),c=o(!0),S=o(0),y=o(null),t=o(null),r=o(null),b=`https://taptaptap.coinclicker.app/uploads/BuildTown/buildes.wasm?v=${D}`,f="https://taptaptap.coinclicker.app/uploads/BuildTown",_=`${f}/buildes.loader.js`,k={dataUrl:`${f}/buildes.data`,frameworkUrl:`${f}/buildes.framework.js`,codeUrl:b,streamingAssetsUrl:"",companyName:"DefaultCompany",productName:"DuckCity",productVersion:"1.0.1",showBanner:(e,n)=>{if(r.value){const s=document.createElement("div");s.innerHTML=e,r.value.appendChild(s),n==="error"?s.style.background="red":n==="warning"&&(s.style.background="yellow"),s.style.padding="10px",setTimeout(()=>{r.value&&r.value.removeChild(s)},5e3)}}},M=e=>{p.value=`${100*e}%`,e==1&&console.log("load Finish")},B=()=>{var e;(e=t.value)==null||e.SetFullscreen(1)};return window.GetSkins=function(){t.value.SendMessage("GameManager","OnInitSkins",a.skins)},window.GetLastVisit=function(){t.value.SendMessage("FoodSlider","OnSetFoodSlider",JSON.stringify(a.town))},window.GetEnergy=function(){var e,n;t.value.SendMessage("EmojiSlider","OnSetTownEmoji",JSON.stringify({energy:(e=a.user)==null?void 0:e.energy,energy_level:(n=a.user)==null?void 0:n.energy_level}))},window.TryBuy=function(e){if(console.log(e),!!a.user){if(a.user.balance<e){m().showAlert("У вас недостаточно 🐥 для покупки данной постройки");return}l.tryBuy(e).then(n=>{if(n){if(!a.user)return;a.user.balance-=e,t.value.SendMessage("WebGLCallbackHandler","OnAccept")}})}},window.GetReferals=function(){l.getReferals().then(e=>{console.log(e);const n={referals:e};t.value.SendMessage("Referal_Window","OnSetReferals",JSON.stringify(n))})},window.SaveJSON=function(e){console.log(e),l.saveUserBuildings(e).then(n=>{n&&(console.log(n),a.getTown())})},window.CheckUserIsland=function(e){console.log(e),l.checkReferalIsland(Number(e)).then(n=>{n?t.value.SendMessage("Referal_Window","VisitIsland"):t.value.SendMessage("Referal_Window","ReferalWithoutIsland")})},window.GetReferalTown=function(e){l.getReferalIsland(Number(e)).then(n=>{t.value.SendMessage("GameManager","OnSetReferalTown",n)})},window.window.GetBuildings=function(){l.getUserBuildings().then(e=>{t.value.SendMessage("GameManager","OnSetMyTown",e)})},window.GetReferalSkins=function(e){l.getReferalSkins(Number(e)).then(n=>{t.value.SendMessage("GameManager","OnInitSkins",n)})},window.IncreaseFood=function(e){if(a.user){if(a.user.balance<Number(e)){m().showAlert("Недостаточно коинов 🐥");return}l.onSetFood(Number(e)).then(n=>{if(n){if(!a.user)return;a.user.balance-=Number(e),t.value.SendMessage("FoodSlider","OnAcceptFood")}})}},U(async()=>{var n,s;if(((n=a.user)==null?void 0:n.id)!=null&&(S.value=(s=a.user)==null?void 0:s.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const d=document.createElement("meta");d.name="viewport",d.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(d),g.value="unity-mobile",w.value=window.innerWidth,h.value=window.innerHeight}c.value=!0;const e=document.createElement("script");e.src=_,e.onload=async()=>{try{t.value=await createUnityInstance(y.value,k,M),c.value=!1}catch(d){alert(d)}},document.body.appendChild(e)}),G(()=>{t.value&&t.value.Quit().then(()=>{t.value=null})}),(e,n)=>(O(),R("div",{id:"unity-container",class:W(g.value)},[i("canvas",{id:"unity-canvas",ref_key:"canvas",ref:y,width:w.value,height:h.value,tabindex:"-1"},null,8,J),T(i("div",H,[P,i("div",V,[i("div",{id:"unity-progress-bar-full",style:F({width:p.value})},null,4)])],512),[[C,c.value]]),i("div",{id:"unity-warning",ref_key:"warningBanner",ref:r},null,512),i("div",{id:"unity-footer"},[j,i("div",{id:"unity-fullscreen-button",onClick:B}),z])],2))}}),q=$(L,[["__scopeId","data-v-b5523bcb"]]);export{q as default};
