import{d as N,u as U,r as s,z as m,o as F,J as M,b as O,c as C,e as a,B as G,K as I,n as T,v as E,x as A,y as x,_ as H}from"./index-BhRRhCFT.js";import{u as P}from"./games-T0O5idbF.js";const g=u=>(A("data-v-167b7291"),u=u(),x(),u),W=["width","height"],$={id:"unity-loading-bar"},J=g(()=>a("div",{id:"unity-logo"},null,-1)),D={id:"unity-progress-bar-empty"},R=g(()=>a("div",{id:"unity-webgl-logo"},null,-1)),j=g(()=>a("div",{id:"unity-build-title"},"FlappyDick",-1)),z=N({__name:"Town",setup(u){const r=P(),t=U(),f=s("unity-desktop"),h=s(960),p=s(600),w=s("0%"),v=s(!0),S=s(0),y=s(null),i=s(null),l=s(null),c="https://taptaptap.coinclicker.app/uploads/BuildTown",_=`${c}/buildes.loader.js`,b={dataUrl:`${c}/buildes.data`,frameworkUrl:`${c}/buildes.framework.js`,codeUrl:`${c}/buildes.wasm`,streamingAssetsUrl:"",companyName:"DefaultCompany",productName:"FlappyDick",productVersion:"0.1",showBanner:(e,n)=>{if(l.value){const o=document.createElement("div");o.innerHTML=e,l.value.appendChild(o),n==="error"?o.style.background="red":n==="warning"&&(o.style.background="yellow"),o.style.padding="10px",setTimeout(()=>{l.value&&l.value.removeChild(o)},5e3)}}},B=e=>{w.value=`${100*e}%`,e==1&&console.log("load Finish")},k=()=>{var e;(e=i.value)==null||e.SetFullscreen(1)};return window.GetSkins=function(){i.value.SendMessage("GameManager","OnInitSkins",t.skins)},window.GetLastVisit=function(){i.value.SendMessage("FoodSlider","OnSetFoodSlider",JSON.stringify(t.town))},window.GetEnergy=function(){var e,n;i.value.SendMessage("EmojiSlider","OnSetTownEmoji",JSON.stringify({energy:(e=t.user)==null?void 0:e.energy,energy_level:(n=t.user)==null?void 0:n.energy_level}))},window.TryBuy=function(e){if(console.log(e),!!t.user){if(t.user.balance<e){m().showAlert("У вас недостаточно 🐥 для покупки данной постройки");return}r.tryBuy(e).then(n=>{if(n){if(!t.user)return;t.user.balance-=e,i.value.SendMessage("WebGLCallbackHandler","OnAccept")}})}},window.GetReferals=function(){r.getReferals().then(e=>{console.log(e);const n={referals:e};i.value.SendMessage("Referal_Window","OnSetReferals",JSON.stringify(n))})},window.SaveJSON=function(e){console.log(e),r.saveUserBuildings(e).then(n=>{n&&(console.log(n),t.getTown())})},window.GetBuildings=function(){r.getUserBuildings().then(e=>{i.value.SendMessage("GameManager","OnSetBuildings",e)})},window.IncreaseFood=function(e){if(t.user){if(t.user.balance<Number(e)){m().showAlert("Недостаточно коинов 🐥");return}r.onSetFood(Number(e)).then(n=>{if(n){if(!t.user)return;t.user.balance-=Number(e),i.value.SendMessage("FoodSlider","OnAcceptFood")}})}},F(async()=>{var n,o;if(((n=t.user)==null?void 0:n.id)!=null&&(S.value=(o=t.user)==null?void 0:o.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const d=document.createElement("meta");d.name="viewport",d.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(d),f.value="unity-mobile",h.value=window.innerWidth,p.value=window.innerHeight}v.value=!0;const e=document.createElement("script");e.src=_,e.onload=async()=>{try{i.value=await createUnityInstance(y.value,b,B),v.value=!1}catch(d){alert(d)}},document.body.appendChild(e)}),M(()=>{i.value&&i.value.Quit().then(()=>{i.value=null})}),s({userHP:0,userName:"",enemyHP:0,enemyName:""}),s(0),(e,n)=>(O(),C("div",{id:"unity-container",class:E(f.value)},[a("canvas",{id:"unity-canvas",ref_key:"canvas",ref:y,width:h.value,height:p.value,tabindex:"-1"},null,8,W),G(a("div",$,[J,a("div",D,[a("div",{id:"unity-progress-bar-full",style:T({width:w.value})},null,4)])],512),[[I,v.value]]),a("div",{id:"unity-warning",ref_key:"warningBanner",ref:l},null,512),a("div",{id:"unity-footer"},[R,a("div",{id:"unity-fullscreen-button",onClick:k}),j])],2))}}),K=H(z,[["__scopeId","data-v-167b7291"]]);export{K as default};
