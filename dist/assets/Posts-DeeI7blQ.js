import{d as K,u as ne,B as ve,r as _,C as ge,b as a,c as i,e,t as d,n as oe,g as y,m as u,F as $,_ as Y,x as I,l as me,o as he,q as _e,f as ee,p as O,h as te,v as N,I as ye,G as H,H as se,A as V,y as xe,z as be}from"./index-Dj9TE7z8.js";const Ce="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%20width='200'%20height='200'%20style='shape-rendering:%20auto;%20display:%20block;'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cg%20transform='translate(80,50)'%3e%3cg%20transform='rotate(0)'%3e%3ccircle%20fill-opacity='1'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.875s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.875s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(71.21320343559643,71.21320343559643)'%3e%3cg%20transform='rotate(45)'%3e%3ccircle%20fill-opacity='0.875'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.75s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.75s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(50,80)'%3e%3cg%20transform='rotate(90)'%3e%3ccircle%20fill-opacity='0.75'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.625s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.625s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(28.786796564403577,71.21320343559643)'%3e%3cg%20transform='rotate(135)'%3e%3ccircle%20fill-opacity='0.625'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.5s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.5s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(20,50.00000000000001)'%3e%3cg%20transform='rotate(180)'%3e%3ccircle%20fill-opacity='0.5'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.375s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.375s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(28.78679656440357,28.786796564403577)'%3e%3cg%20transform='rotate(225)'%3e%3ccircle%20fill-opacity='0.375'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.25s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.25s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(49.99999999999999,20)'%3e%3cg%20transform='rotate(270)'%3e%3ccircle%20fill-opacity='0.25'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='-0.125s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='-0.125s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%20transform='translate(71.21320343559643,28.78679656440357)'%3e%3cg%20transform='rotate(315)'%3e%3ccircle%20fill-opacity='0.125'%20fill='%2327ff00'%20r='6'%20cy='0'%20cx='0'%3e%3canimateTransform%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='1.5%201.5;1%201'%20begin='0s'%20type='scale'%20attributeName='transform'%3e%3c/animateTransform%3e%3canimate%20begin='0s'%20values='1;0'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20attributeName='fill-opacity'%3e%3c/animate%3e%3c/circle%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/g%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io%20--%3e%3c/svg%3e",ke="/assets/acceptet-BiKVjkxi.svg",we={class:"balance-panel"},Pe={class:"balance-hint"},Ie={class:"balance__wrapper"},Te={key:0,style:{display:"flex",justifyContent:"center"}},De=K({__name:"DonateBalance",props:{popupState:{type:Function}},setup(C){const t=ne(),p=C,k=ve(()=>{var w;const v=((w=t.posts_balance)==null?void 0:w.toString().length)||0;return v<5?"44px":v<8?"39px":v<12?"34px":v<15?"29px":"24px"}),x=_(t.posts_balance||0);function c(v){const w=x.value,U=v-w;let R=900;U<=10&&(R=300);const G=performance.now();function j(L){const B=L-G,m=Math.min(B/R,1);x.value=Math.round(w+U*m),m<1&&requestAnimationFrame(j)}requestAnimationFrame(j)}ge(()=>t.posts_balance??0,v=>{c(v)},{immediate:!0});const f=()=>{p.popupState("change")};return(v,w)=>(a(),i($,null,[e("div",we,[e("span",Pe,d(v.$t("account.yourDonateBalance")),1),e("div",Ie,[e("div",{class:"balance",style:oe({fontSize:k.value})},d(x.value.toLocaleString()),5)])]),y(t).posts_balance!=null&&y(t).posts_balance>0?(a(),i("div",Te,[e("div",{style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},[e("button",{class:"boost-purchase-button",onClick:f},"Обменять")])])):u("",!0)],64))}}),Se=Y(De,[["__scopeId","data-v-626c8c18"]]),Ae="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M3%2010C3%206.22876%203%204.34315%204.17157%203.17157C5.34315%202%207.22876%202%2011%202H13C16.7712%202%2018.6569%202%2019.8284%203.17157C21%204.34315%2021%206.22876%2021%2010V14C21%2017.7712%2021%2019.6569%2019.8284%2020.8284C18.6569%2022%2016.7712%2022%2013%2022H11C7.22876%2022%205.34315%2022%204.17157%2020.8284C3%2019.6569%203%2017.7712%203%2014V10ZM6%2012C6%2010.5858%206%209.87868%206.43934%209.43934C6.87868%209%207.58579%209%209%209H15C16.4142%209%2017.1213%209%2017.5607%209.43934C18%209.87868%2018%2010.5858%2018%2012V16C18%2017.4142%2018%2018.1213%2017.5607%2018.5607C17.1213%2019%2016.4142%2019%2015%2019H9C7.58579%2019%206.87868%2019%206.43934%2018.5607C6%2018.1213%206%2017.4142%206%2016V12ZM7%205.25C6.58579%205.25%206.25%205.58579%206.25%206C6.25%206.41421%206.58579%206.75%207%206.75H12C12.4142%206.75%2012.75%206.41421%2012.75%206C12.75%205.58579%2012.4142%205.25%2012%205.25H7Z'%20fill='%231C274C'/%3e%3c/svg%3e",Ve="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M3.25%2022C3.25%2021.5858%203.58579%2021.25%204%2021.25H20C20.4142%2021.25%2020.75%2021.5858%2020.75%2022C20.75%2022.4142%2020.4142%2022.75%2020%2022.75H4C3.58579%2022.75%203.25%2022.4142%203.25%2022Z'%20fill='%231C274C'/%3e%3cpath%20d='M11.5201%2014.929L11.5201%2014.9289L17.4368%209.01225C16.6315%208.6771%2015.6777%208.12656%2014.7757%207.22455C13.8736%206.32238%2013.323%205.36846%2012.9879%204.56312L7.07106%2010.4799L7.07101%2010.48C6.60932%2010.9417%206.37846%2011.1725%206.17992%2011.4271C5.94571%2011.7273%205.74491%2012.0522%205.58107%2012.396C5.44219%2012.6874%205.33894%2012.9972%205.13245%2013.6167L4.04356%2016.8833C3.94194%2017.1882%204.02128%2017.5243%204.2485%2017.7515C4.47573%2017.9787%204.81182%2018.0581%205.11667%2017.9564L8.38334%2016.8676C9.00281%2016.6611%209.31256%2016.5578%209.60398%2016.4189C9.94775%2016.2551%2010.2727%2016.0543%2010.5729%2015.8201C10.8275%2015.6215%2011.0584%2015.3907%2011.5201%2014.929Z'%20fill='%231C274C'/%3e%3cpath%20d='M19.0786%207.37044C20.3071%206.14188%2020.3071%204.14999%2019.0786%202.92142C17.85%201.69286%2015.8581%201.69286%2014.6296%202.92142L13.9199%203.63105C13.9296%203.6604%2013.9397%203.69015%2013.9502%203.72028C14.2103%204.47%2014.701%205.45281%2015.6243%206.37602C16.5475%207.29923%2017.5303%207.78999%2018.28%208.05009C18.31%208.0605%2018.3396%208.07054%2018.3688%208.08021L19.0786%207.37044Z'%20fill='%231C274C'/%3e%3c/svg%3e",Me="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='6'%20r='4'%20fill='%231C274C'/%3e%3cpath%20d='M20%2017.5C20%2019.9853%2020%2022%2012%2022C4%2022%204%2019.9853%204%2017.5C4%2015.0147%207.58172%2013%2012%2013C16.4183%2013%2020%2015.0147%2020%2017.5Z'%20fill='%231C274C'/%3e%3c/svg%3e",Ne={class:"navMenu"},Le={class:"nav-btn__wrapper"},Be=["src"],$e=["src"],Ue=["src"],Re={class:"nav-btn__text"},je=K({__name:"NavMenu",props:{pageState:{}},emits:["change-page-state"],setup(C,{emit:t}){const p=C,k=t,x=c=>{c!==p.pageState&&k("change-page-state",c)};return(c,f)=>(a(),i("div",Ne,[e("div",Le,[e("button",{class:I(["post-component__nav-btn feed",{active:p.pageState==="posts"}]),onClick:f[0]||(f[0]=v=>x("posts"))},[e("img",{src:y(Ae)},null,8,Be)],2),e("button",{class:I(["post-component__nav-btn compose",{active:p.pageState==="create"}]),onClick:f[1]||(f[1]=v=>x("create"))},[e("img",{src:y(Ve)},null,8,$e)],2),e("button",{class:I(["post-component__nav-btn profile",{active:p.pageState==="myposts"}]),onClick:f[2]||(f[2]=v=>x("myposts"))},[e("img",{src:y(Me)},null,8,Ue)],2)]),e("div",Re,[e("span",{class:I(["nav-btn__text-item",{active:p.pageState==="posts"}])},"Posts",2),e("span",{class:I(["nav-btn__text-item",{active:p.pageState==="create"}])},"Write",2),e("span",{class:I(["nav-btn__text-item",{active:p.pageState==="myposts"}])},"Profile",2)])]))}}),ze=Y(je,[["__scopeId","data-v-b75ae643"]]),h=C=>(xe("data-v-2dab9646"),C=C(),be(),C),Fe=h(()=>e("div",{class:"Bg"},null,-1)),He={key:0,class:"createPostMenu"},Ge={id:"progressbar"},Ee={class:"createForm"},We={key:0,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},Ze=h(()=>e("span",{style:{fontWeight:"bold",marginTop:"15px"}},"⚠️ Добавить можно только 1 изображение",-1)),Oe={class:"sec-center",style:{marginTop:"20px"}},Ke=h(()=>e("input",{class:"dropdown",type:"checkbox",id:"dropdown",name:"dropdown"},null,-1)),Ye={class:"for-dropdown",for:"dropdown"},qe={class:"section-dropdown"},Xe=h(()=>e("i",{class:"uil uil-arrow-right"},"💸",-1)),Je=h(()=>e("i",{class:"uil uil-arrow-right"},"🗳️",-1)),Qe={key:1,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},et=h(()=>e("label",{for:"fname"},"Описание(не обязательно)",-1)),tt={key:2,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},st={key:0,style:{display:"flex",alignItems:"center"}},nt=h(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Платный пост (не обязательно)",-1)),ot={class:"checkbox-wrapper-7",style:{marginLeft:"20px"}},at=h(()=>e("label",{class:"tgl-btn",for:"cb2-7"},null,-1)),it={key:1,style:{display:"flex",alignItems:"center",flexDirection:"column"}},lt=h(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Цена голосования (в 🍆):",-1)),ct={key:2,style:{marginTop:"50px",textAlign:"center"}},rt=h(()=>e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Цена за разблокировку:",-1)),ut=h(()=>e("div",{style:{marginTop:"50px",textAlign:"center"}},[e("span",{style:{fontSize:"15px",fontWeight:"bold"}},"Стоимость создания поста: 1000🍆")],-1)),dt={key:3},pt={key:0,style:{display:"flex",flexDirection:"column"}},ft=["src"],vt=h(()=>e("span",{style:{fontSize:"17px",fontWeight:"bold",marginTop:"10px"}},"Подождите, мы загружаем ваш пост...",-1)),gt={key:1},mt=["src"],ht={key:0,style:{display:"flex",justifyContent:"center"}},_t={key:1,class:"boosts"},yt={class:"post"},xt={class:"ownerData"},bt=["src"],Ct=["src"],kt={class:"postDescription"},wt={key:0,class:"unlock",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},Pt={style:{fontSize:"14px"}},It=["onClick"],Tt={key:1,class:"donations",style:{height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"15px"}},Dt={class:"donation__counter"},St=["onClick"],At={key:2},Vt={class:"vote__counter"},Mt={class:"vote__counter-actions"},Nt={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},Lt={style:{fontSize:"18px"}},Bt=["onClick"],$t={style:{display:"felx",flexDirection:"column",justifyContent:"center",textAlign:"center"}},Ut={style:{fontSize:"18px"}},Rt=["onClick"],jt={class:"popup-content"},zt={class:"popup-header"},Ft=h(()=>e("svg",{class:"close-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"16px",height:"16px"},[e("path",{d:"M 7 4 C 6.744125 4 6.4879687 4.0974687 6.2929688 4.2929688 L 4.2929688 6.2929688 C 3.9019687 6.6839688 3.9019687 7.3170313 4.2929688 7.7070312 L 11.585938 15 L 4.2929688 22.292969 C 3.9019687 22.683969 3.9019687 23.317031 4.2929688 23.707031 L 6.2929688 25.707031 C 6.6839688 26.098031 7.3170313 26.098031 7.7070312 25.707031 L 15 18.414062 L 22.292969 25.707031 C 22.682969 26.098031 23.317031 26.098031 23.707031 25.707031 L 25.707031 23.707031 C 26.098031 23.316031 26.098031 22.682969 25.707031 22.292969 L 18.414062 15 L 25.707031 7.7070312 C 26.098031 7.3170312 26.098031 6.6829688 25.707031 6.2929688 L 23.707031 4.2929688 C 23.316031 3.9019687 22.682969 3.9019687 22.292969 4.2929688 L 15 11.585938 L 7.7070312 4.2929688 C 7.5115312 4.0974687 7.255875 4 7 4 z"})],-1)),Ht=[Ft],Gt={key:0,class:"popup-body"},Et=h(()=>e("p",null,"Price:",-1)),Wt={key:1,class:"popup-body"},Zt={class:"slidecontainer",style:{marginTop:"30px"}},Ot=["max"],Kt={key:2},Yt=["src"],qt={key:0},Xt={key:3},Jt={class:"slidecontainer",style:{marginTop:"30px"}},Qt=["max"],es={key:2,class:"myPosts"},ts=["onClick"],ss=h(()=>e("div",{class:"icon-box",style:{fontSize:"27px"}},"🌐",-1)),ns={class:"text-container",style:{display:"flex",justifyContent:"center"}},os={style:{marginLeft:"11px"}},as=K({__name:"Posts",setup(C){me();const t=ne();t.getBoosts(),_(!1),_(!1);const p=_("posts"),k=_(!1),x=_(!1),c=_({image:null,isPrivate:!1,description:"",type:"",price:0,votePrice:0}),f=_(0),v=[{id:0,isActive:!0,text:"Add image"},{id:1,isActive:!1,text:"Write description"},{id:2,isActive:!1,text:"Choose Details"}];async function w(){try{await Promise.all([t.getMyBoughtPosts(),t.getPosts().then(o=>{if(o){if(t.posts==null)return;const n=t.posts.filter(s=>s.Type==="donate"),l=t.posts.filter(s=>s.Type==="vote"),r=[];for(;n.length>0||l.length>0;){if(n.length>0){const s=n.shift();s!==void 0&&r.push(s)}if(l.length>0){const s=l.shift();s!==void 0&&r.push(s)}}t.posts=r,t.posts.forEach(s=>{fe(s.AvatarURL)||(s.AvatarURL="https://storage.googleapis.com/clicker_bucket/user.png")})}}),t.getMyPosts(),t.getMyPostsBalance()])}catch(o){console.error("Error fetching user data:",o)}}he(()=>{p.value="posts",w()});const U=o=>{o!==p.value&&(p.value=o)},R=o=>{const l=o.target.files;if(l&&l.length>0){const r=l[0],s=new FileReader;s.onload=b=>{var M;const P=new Image;P.onload=()=>{const F=document.createElement("canvas"),J=F.getContext("2d"),W=1024,Z=1024;let S=P.width,A=P.height;S>A?S>W&&(A*=W/S,S=W):A>Z&&(S*=Z/A,A=Z),F.width=S,F.height=A,J!=null&&J.drawImage(P,0,0,S,A),F.toBlob(Q=>{Q&&(c.value.image=new File([Q],r.name,{type:r.type}),x.value=!0)},r.type,.8)},P.src=(M=b.target)==null?void 0:M.result},s.readAsDataURL(r)}},G=o=>{console.log(1);const l=o.target.value;l&&(c.value.description=l),console.log(c)},j=()=>{f.value!==0&&(x.value=!1),f.value++,v[f.value].isActive=!0},L=_(!1),B=()=>{if(t.user){if(t.user.balance<1e3){V().showAlert("Недостаточно 🍆 для создания поста");return}if(c.value.isPrivate=k.value,c.value.image!=null){const o={image:c.value.image,isPrivate:c.value.isPrivate,description:c.value.description,price:c.value.price,type:c.value.type,votePrice:c.value.votePrice};f.value++,t.createPost(o).then(n=>{n&&setTimeout(()=>{f.value=0,p.value="posts",v.forEach(l=>{l.id!==0&&(l.isActive=!1)}),L.value=!0,L.value=!1,t.getPosts(),t.getMyPosts()},2500)})}else V().showAlert("Не выбрано изображение")}},m=_("close"),g=_({id:0,price:0,imagePath:"",decription:"",donated:0}),z=(o,n,l,r,s,b)=>{m.value=o,g.value.id=n,g.value.price=l,g.value.imagePath=r!==null?r:"",g.value.decription=s!==null?s:"",g.value.donated=b!==null?b:0},ae=()=>{if(t.user){if(t.user.balance<g.value.price){V().showAlert("Недостаточно средств на счету");return}console.log(g.value.id),t.unlockPost(g.value.id).then(o=>{if(o&&t.posts!=null){let n=t.posts.findIndex(l=>l.ID==g.value.id);n!=-1&&(t.posts[n].IsPrivate=!1,t.getMyBoughtPosts())}})}},ie=(o,n)=>{var l;if(t.user){if(t.posts!=null&&t.posts[t.posts.findIndex(r=>r.ID==o)].Type!="donate"||t.user.id==n||t.posts!=null&&!t.posts[t.posts.findIndex(r=>r.ID==o)].IsPrivate)return!1;if(t.posts!=null&&t.posts[t.posts.findIndex(r=>r.ID==o)].IsPrivate)if(t.boughtPosts!=null){if(t.boughtPosts.length<0)return!0;if(((l=t.boughtPosts)==null?void 0:l.length)>0)return t.boughtPosts.findIndex(r=>r.PostID==o)==-1}else return!0}},le=(o,n)=>{if(t.user)return t.user.id==o||t.posts!=null&&!t.posts[t.posts.findIndex(l=>l.ID==n)].IsPrivate?!1:o!=t.user.id?!ce(n):!0},ce=o=>{if(t.boughtPosts!=null&&t.boughtPosts.length>0){let n=t.boughtPosts.findIndex(l=>l.PostID==o);if(console.log(n,o),n!=-1)return console.log(n),!0}return!1},T=_(0),re=()=>{if(t.user){if(t.user.balance<Number(T.value)){V().showAlert("Недостаточно средств на счету");return}t.donatePost(g.value.id,T.value).then(o=>{if(o&&t.posts!=null){let n=t.posts.findIndex(l=>l.ID==g.value.id);n!=-1&&(t.posts[n].Donated+=Number(T.value))}})}},ue=o=>{switch(o){case"unlock":return"Unlock post?";case"donate":return"Donate post?";case"visible":return`Post: ${g.value.id}`;case"change":return"Exchange donated dicks for basic ones?"}},D=_(0),de=()=>{t.user&&(t.posts_balance!=null&&t.posts_balance<D.value&&V().showAlert("ⓘ Недостаточно средств для вывода!"),V().showAlert("ⓘ Система удерживает 30% комиссию при переводе средств с донатного счёта на основной! ⓘ"),t.exchangeDonateMoney(D.value).then(o=>{o&&t.posts_balance!=null&&(t.posts_balance-=D.value)}))},q=o=>{c.value.type=o},pe=o=>{switch(o){case"donate":return"Донатный 💸";case"vote":return"Голосование 🗳️"}return""},X=(o,n,l)=>{if(t.user){if(t.user.balance<l){V().showAlert("Недостаточно 🍆 для голосования");return}t.votePost(o,n).then(r=>{if(r&&t.posts!=null){let s=t.posts.findIndex(b=>b.ID==o);if(s!=-1)switch(n){case"yes":t.posts[s].VoteYes+=1;break;case"no":t.posts[s].VoteNo+=1;break}}})}},E=o=>{o.target.blur()};async function fe(o){try{return(await fetch(o,{method:"HEAD"})).ok}catch{return!1}}return(o,n)=>{var r;const l=_e("click-outside");return a(),i($,null,[Fe,ee(ze,{"page-state":p.value,onChangePageState:U},null,8,["page-state"]),p.value==="create"?(a(),i("div",He,[e("div",null,[e("ul",Ge,[(a(),i($,null,O(v,s=>e("li",{class:I(s.isActive?"active":"")},d(s.text),3)),64))])]),e("div",Ee,[f.value===0?(a(),i("div",We,[e("input",{class:"addFile",type:"file",onChange:R},null,32),Ze,e("div",Oe,[Ke,e("label",Ye,d(c.value.type==""?"Выберите тип поста":pe(c.value.type)),1),e("div",qe,[e("a",{onClick:n[0]||(n[0]=s=>q("donate"))},[te("Донатный "),Xe]),e("a",{onClick:n[1]||(n[1]=s=>q("vote"))},[te("Голосование "),Je])])])])):u("",!0),f.value===1?(a(),i("div",Qe,[et,N(e("input",{type:"text",id:"fname",onChange:G,name:"fname"},null,544),[[l,E]])])):u("",!0),f.value===2?(a(),i("div",tt,[c.value.type!="vote"?(a(),i("div",st,[nt,e("div",ot,[N(e("input",{class:"tgl tgl-ios",id:"cb2-7",type:"checkbox","onUpdate:modelValue":n[2]||(n[2]=s=>k.value=s)},null,512),[[ye,k.value]]),at])])):u("",!0),c.value.type=="vote"?(a(),i("div",it,[lt,N(e("input",{type:"number",onKeydown:se(B,["enter"]),"onUpdate:modelValue":n[3]||(n[3]=s=>c.value.votePrice=s),style:{width:"100%"}},null,544),[[l,E],[H,c.value.votePrice]])])):u("",!0),k.value?(a(),i("div",ct,[rt,N(e("input",{type:"number",onKeydown:se(B,["enter"]),"onUpdate:modelValue":n[4]||(n[4]=s=>c.value.price=s)},null,544),[[l,E],[H,c.value.price]])])):u("",!0),ut,e("div",null,[e("button",{class:"mypost-button",style:{marginTop:"30px"},onClick:B},"Создать")])])):u("",!0),f.value===3?(a(),i("div",dt,[L.value?(a(),i("div",gt,[e("img",{src:y(ke)},null,8,mt)])):(a(),i("div",pt,[e("img",{src:y(Ce)},null,8,ft),vt]))])):u("",!0)]),x.value?(a(),i("div",ht,[e("button",{class:"mypost-button",style:{marginTop:"30px"},onClick:j},"Дальше")])):u("",!0)])):u("",!0),p.value==="posts"?(a(),i("div",_t,[(a(!0),i($,null,O(y(t).posts,(s,b)=>{var P;return a(),i("div",{key:s.ID,style:{width:"100%"}},[e("div",yt,[e("div",xt,[e("img",{src:s.AvatarURL},null,8,bt),e("span",null,d(s.OwnerName),1)]),e("div",{class:"postImage",style:oe({filter:le(s.OwnerID,s.ID)?"blur(25px)":"blur(0px)"})},[e("img",{src:s.ImagePath,style:{maxWidth:"100%",height:"auto",width:"100%"}},null,8,Ct)],4),e("div",kt,[e("span",null,d(s.Description),1)]),ie(s.ID,s.OwnerID)?(a(),i("div",wt,[e("span",Pt,"🍆"+d(s.Price),1),e("button",{class:"boost-purchase-button",onClick:M=>z("unlock",s.ID,s.Price,null,null,null)},"Unlock",8,It)])):u("",!0),s.Type!="vote"?(a(),i("div",Tt,[e("span",Dt,"Donated: 🍆"+d(s.Donated),1),s.OwnerID!==((P=y(t).user)==null?void 0:P.id)?(a(),i("button",{key:0,class:"boost-purchase-button",onClick:M=>z("donate",s.ID,s.Price,null,null,null)},"Donate",8,St)):u("",!0)])):(a(),i("div",At,[e("div",Vt,[e("span",null,"Всего: "+d((s.VoteYes+s.VoteNo)*s.VotePrice)+"🍆",1)]),e("div",Mt,[e("div",Nt,[e("span",Lt,d(s.VoteYes)+" ✅",1),e("button",{class:"boost-purchase-button",style:{marginLeft:"15px",marginTop:"10px",height:"40px",backgroundColor:"#3f8b1e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:M=>X(s.ID,"yes",s.VotePrice)},"Да "+d(s.VotePrice)+"🍆",9,Bt)]),e("div",$t,[e("span",Ut,d(s.VoteNo)+" ❌",1),e("button",{class:"boost-purchase-button",style:{marginRight:"15px",marginTop:"10px",height:"40px",backgroundColor:"#bc0e0e",display:"flex",justifyContent:"center",alignItems:"center"},onClick:M=>X(s.ID,"no",s.VotePrice)},"Нет "+d(s.VotePrice)+"🍆",9,Rt)])])]))])])}),128))])):u("",!0),e("div",{class:I(["boost-purchase-popup",{visible:m.value=="unlock"||m.value=="donate"||m.value=="visible"||m.value=="change"}]),onClick:n[8]||(n[8]=()=>{m.value="close"})},[e("div",jt,[e("div",zt,[e("h2",null,d(ue(m.value)),1),e("button",{class:"close-button",onClick:n[5]||(n[5]=()=>{m.value="close"})},Ht)]),m.value=="unlock"?(a(),i("div",Gt,[Et,e("p",null,"🍆"+d(g.value.price),1),e("button",{class:"boost-purchase-button",style:{width:"100%"},onClick:ae},"Unlock post")])):u("",!0),m.value=="donate"?(a(),i("div",Wt,[e("div",Zt,[N(e("input",{type:"range",min:"0",max:(r=y(t).user)==null?void 0:r.balance,class:"slider",id:"myRange","onUpdate:modelValue":n[6]||(n[6]=s=>T.value=s)},null,8,Ot),[[H,T.value]])]),e("p",null,"🍆"+d(T.value),1),T.value>0?(a(),i("button",{key:0,class:"boost-purchase-button",style:{width:"100%"},onClick:re},"Donate post")):u("",!0)])):u("",!0),m.value=="visible"?(a(),i("div",Kt,[e("img",{src:g.value.imagePath,style:{height:"200px",width:"100%",backgroundRepeat:"no-repeat",objectFit:"contain"}},null,8,Yt),g.value.decription!==""?(a(),i("p",qt,d(g.value.decription),1)):u("",!0),e("p",null,"Donated: 🍆"+d(g.value.donated),1)])):u("",!0),m.value=="change"?(a(),i("div",Xt,[e("div",Jt,[N(e("input",{type:"range",min:"0",max:y(t).posts_balance!==null?y(t).posts_balance:0,class:"slider",id:"myRange","onUpdate:modelValue":n[7]||(n[7]=s=>D.value=s)},null,8,Qt),[[H,D.value]])]),e("p",null,"🍆"+d(D.value),1),D.value>0?(a(),i("button",{key:0,class:"boost-purchase-button",style:{width:"100%"},onClick:de},"Exchange")):u("",!0)])):u("",!0)])],2),p.value=="myposts"?(a(),i("div",es,[ee(Se,{popupState:z}),(a(!0),i($,null,O(y(t).myPosts,s=>(a(),i("div",{class:"postProfile",onClick:b=>z("visible",s.ID,s.Price,s.ImagePath,s.Description,s.Donated)},[ss,e("div",ns,[e("span",os,"Пост: "+d(s.ID),1)])],8,ts))),256))])):u("",!0)],64)}}}),ls=Y(as,[["__scopeId","data-v-2dab9646"]]);export{ls as default};
