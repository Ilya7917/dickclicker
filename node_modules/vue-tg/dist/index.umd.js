(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a["vue-tg"]={},a.Vue))})(this,function(a,n){"use strict";const A=n.defineComponent({__name:"Alert",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:o}){const t=e,{showAlert:i}=b();return n.onMounted(()=>i(t.message,()=>o("close"))),(s,r)=>(n.openBlock(),n.createElementBlock("div"))}}),W=n.defineComponent({__name:"BackButton",props:{visible:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:o}){const t=e,{showBackButton:i,onBackButtonClicked:s,hideBackButton:r}=E();return n.watch(()=>t.visible,l=>{l?i():r()}),s(()=>o("click")),n.onMounted(()=>t.visible&&i()),n.onUnmounted(()=>r()),(l,g)=>(n.openBlock(),n.createElementBlock("div"))}}),T=n.defineComponent({__name:"Confirm",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:o}){const t=e,{showConfirm:i}=b();return n.onMounted(()=>i(t.message,s=>o("close",s))),(s,r)=>(n.openBlock(),n.createElementBlock("div"))}}),C=n.defineComponent({__name:"MainButton",props:{text:{type:String},color:{type:String},textColor:{type:String},visible:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},progress:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:o}){const t=e,{setMainButtonParams:i,onMainButtonClicked:s,hideMainButton:r,showMainButtonProgress:l,hideMainButtonProgress:g}=J();return n.watch(()=>t.text,c=>{i({text:c})}),n.watch(()=>t.color,c=>{i({color:c})}),n.watch(()=>t.textColor,c=>{i({text_color:c})}),n.watch(()=>t.visible,c=>{i({is_visible:c})}),n.watch(()=>t.disabled,c=>{i({is_active:!c})}),n.watch(()=>t.progress,c=>{c?l():g()}),s(()=>o("click")),n.onMounted(()=>{t.progress?l():g(),i({text:t.text,text_color:t.textColor,color:t.color,is_active:!t.disabled,is_visible:t.visible})}),n.onUnmounted(()=>{g(),r()}),(c,m)=>(n.openBlock(),n.createElementBlock("div"))}}),h=n.defineComponent({__name:"Popup",props:{title:{type:String},message:{type:String,required:!0},buttons:{type:Array}},emits:["close"],setup(e,{emit:o}){const t=e,{showPopup:i}=b();return n.onMounted(()=>i({title:t.title,message:t.message,buttons:t.buttons},s=>o("close",s))),(s,r)=>(n.openBlock(),n.createElementBlock("div"))}}),{initData:re,initDataUnsafe:ce,version:pe,platform:le,isVersionAtLeast:ue,sendData:me,close:de}=Telegram.WebApp,k=n.ref(!1),ge=(...e)=>{Telegram.WebApp.ready(...e),k.value=!0},M=e=>Telegram.WebApp.platform===e,S=M("unknown"),be=!S&&Telegram.WebApp.initData==="";function p(){return{initData:re,initDataUnsafe:ce,version:pe,platform:le,isVersionAtLeast:ue,onEvent:(...o)=>{n.onMounted(()=>Telegram.WebApp.onEvent(...o)),n.onUnmounted(()=>Telegram.WebApp.offEvent(...o))},sendData:me,ready:ge,close:de,isReady:n.readonly(k),isPlatform:M,isPlatformUnknown:S,canSendData:be}}const w=n.ref(Telegram.WebApp.BackButton.isVisible);function _(){w.value=Telegram.WebApp.BackButton.isVisible}function P(...e){Telegram.WebApp.BackButton.show(...e),_()}function y(...e){Telegram.WebApp.BackButton.hide(...e),_()}function E(){const{onEvent:e}=p(),o=t=>e("backButtonClicked",t);return{isBackButtonVisible:n.computed({get(){return w.value},set(t){t?P():y()}}),onBackButtonClicked:o,showBackButton:P,hideBackButton:y}}const{readTextFromClipboard:fe}=Telegram.WebApp;function Be(){const{onEvent:e}=p();return{readTextFromClipboard:fe,onClipboardTextReceived:t=>e("clipboardTextReceived",t)}}const v=n.ref(Telegram.WebApp.isClosingConfirmationEnabled);function x(){v.value=Telegram.WebApp.isClosingConfirmationEnabled}function D(...e){Telegram.WebApp.enableClosingConfirmation(...e),x()}function R(...e){Telegram.WebApp.disableClosingConfirmation(...e),x()}function Ae(){return{isClosingConfirmationEnabled:n.computed({get(){return v.value},set(e){e?D():R()}}),enableClosingConfirmation:D,disableClosingConfirmation:R}}const d=Telegram.WebApp.CloudStorage;function We(e,o){return new Promise((t,i)=>{d.setItem(e,o,(s,r)=>{s&&i(s),t(r)})})}function Te(e){return new Promise((o,t)=>{d.getItem(e,(i,s)=>{i&&t(i),o(s)})})}function Ce(e){return new Promise((o,t)=>{d.getItems(e,(i,s)=>{i&&t(i),o(s)})})}function he(e){return new Promise((o,t)=>{d.removeItem(e,(i,s)=>{i&&t(i),o(s)})})}function ke(e){return new Promise((o,t)=>{d.removeItems(e,(i,s)=>{i&&t(i),o(s)})})}function Me(){return new Promise((e,o)=>{d.getKeys((t,i)=>{t&&o(t),e(i)})})}function Se(){return{setStorageItem:We,getStorageItem:Te,getStorageItems:Ce,removeStorageItem:he,removeStorageItems:ke,getStorageKeys:Me}}const{impactOccurred:we,notificationOccurred:_e,selectionChanged:Pe}=Telegram.WebApp.HapticFeedback;function ye(){return{impactOccurred:we,notificationOccurred:_e,selectionChanged:Pe}}const q=n.ref(Telegram.WebApp.MainButton.text),H=n.ref(Telegram.WebApp.MainButton.color),I=n.ref(Telegram.WebApp.MainButton.textColor),$=n.ref(Telegram.WebApp.MainButton.isVisible),Q=n.ref(Telegram.WebApp.MainButton.isActive),V=n.ref(Telegram.WebApp.MainButton.isProgressVisible);function u(){q.value=Telegram.WebApp.MainButton.text,H.value=Telegram.WebApp.MainButton.color,I.value=Telegram.WebApp.MainButton.textColor,$.value=Telegram.WebApp.MainButton.isVisible,Q.value=Telegram.WebApp.MainButton.isActive,V.value=Telegram.WebApp.MainButton.isProgressVisible}function U(...e){Telegram.WebApp.MainButton.setText(...e),u()}function O(...e){Telegram.WebApp.MainButton.show(...e),u()}function F(...e){Telegram.WebApp.MainButton.hide(...e),u()}function L(...e){Telegram.WebApp.MainButton.enable(...e),u()}function N(...e){Telegram.WebApp.MainButton.disable(...e),u()}function j(...e){Telegram.WebApp.MainButton.showProgress(...e),u()}function z(...e){Telegram.WebApp.MainButton.hideProgress(...e),u()}function f(...e){Telegram.WebApp.MainButton.setParams(...e),u()}function J(){const{onEvent:e}=p(),o=t=>e("mainButtonClicked",t);return{mainButtonText:n.computed({get(){return q.value},set(t){U(t)}}),mainButtonColor:n.computed({get(){return H.value},set(t){f({color:t})}}),mainButtonTextColor:n.computed({get(){return I.value},set(t){f({text_color:t})}}),isMainButtonVisible:n.computed({get(){return $.value},set(t){t?O():F()}}),isMainButtonActive:n.computed({get(){return Q.value},set(t){t?L():N()}}),isMainButtonProgressVisible:n.computed({get(){return V.value},set(t){t?j():z()}}),setMainButtonText:U,onMainButtonClicked:o,showMainButton:O,hideMainButton:F,enableMainButton:L,disableMainButton:N,showMainButtonProgress:j,hideMainButtonProgress:z,setMainButtonParams:f}}const{switchInlineQuery:Ee,openLink:ve,openTelegramLink:xe,openInvoice:De}=Telegram.WebApp;function Re(){const{onEvent:e}=p();return{switchInlineQuery:Ee,openLink:ve,openTelegramLink:xe,openInvoice:De,onInvoiceClosed:t=>e("invoiceClosed",t)}}const{showPopup:qe,showAlert:He,showConfirm:Ie}=Telegram.WebApp;function b(){const{onEvent:e}=p();return{showPopup:qe,showAlert:He,showConfirm:Ie,onPopupClosed:t=>e("popupClosed",t)}}const{showScanQrPopup:$e,closeScanQrPopup:Qe}=Telegram.WebApp;function K(){const{onEvent:e}=p();return{showScanQrPopup:$e,closeScanQrPopup:Qe,onQrTextReceived:t=>e("qrTextReceived",t)}}const{requestContact:Ve,requestWriteAccess:Ue}=Telegram.WebApp;function Oe(){const{onEvent:e}=p();return{requestContact:Ve,onContactRequested:i=>e("contactRequested",i),requestWriteAccess:Ue,onWriteAccessRequested:i=>e("writeAccessRequested",i)}}const{initData:Fe,initDataUnsafe:Le,sendData:Ne,close:je}=p();function ze(e,o){const t=o.serialize??JSON.stringify,i=n.ref(""),s=l=>{i.value=l,console.error(l)},r=n.ref(!1);return{error:i,isLoading:r,execute:()=>{Ne(t(e)),setTimeout(()=>s("Telegram.WebApp.sendData is only available for custom keyboards."),1e3)},executeHttp:async(l,g={})=>{const c=g.closeAfter??!0;r.value=!0;try{const m=await fetch(l,{method:"POST",body:JSON.stringify({initData:Fe,initDataUnsafe:Le,data:t(e)})});return m.ok||s(`${m.status} ${m.statusText}`),m.ok&&c&&je(),m}catch(m){s(String(m))}finally{r.value=!1}}}}function Je(){const{onEvent:e}=p();return{onSettingsButtonClicked:t=>e("settingsButtonClicked",t)}}const G=n.ref(Telegram.WebApp.colorScheme),X=n.ref(Telegram.WebApp.themeParams),Y=n.ref(Telegram.WebApp.headerColor),Z=n.ref(Telegram.WebApp.backgroundColor);function B(){G.value=Telegram.WebApp.colorScheme,X.value=Telegram.WebApp.themeParams,Y.value=Telegram.WebApp.headerColor,Z.value=Telegram.WebApp.backgroundColor}function ee(...e){Telegram.WebApp.setHeaderColor(...e),B()}function te(...e){Telegram.WebApp.setBackgroundColor(...e),B()}function Ke(){const{onEvent:e}=p(),o=t=>e("themeChanged",t);return o(B),{colorScheme:n.readonly(G),themeParams:n.readonly(X),headerColor:n.computed({get(){return Y.value},set(t){ee(t)}}),backgroundColor:n.computed({get(){return Z.value},set(t){te(t)}}),setHeaderColor:ee,setBackgroundColor:te,onThemeChanged:o}}const ne=n.ref(Telegram.WebApp.isExpanded),oe=n.ref(Telegram.WebApp.viewportHeight),ie=n.ref(Telegram.WebApp.viewportStableHeight);function ae(){ne.value=Telegram.WebApp.isExpanded,oe.value=Telegram.WebApp.viewportHeight,ie.value=Telegram.WebApp.viewportStableHeight}function Ge(...e){Telegram.WebApp.expand(...e),ae()}function Xe(){const{onEvent:e}=p(),o=t=>e("viewportChanged",t);return o(ae),{isExpanded:n.readonly(ne),viewportHeight:n.readonly(oe),viewportStableHeight:n.readonly(ie),expand:Ge,onViewportChanged:o}}const se=n.defineComponent({__name:"ScanQr",props:{text:{type:String}},emits:["result"],setup(e,{emit:o}){const t=e,{showScanQrPopup:i,closeScanQrPopup:s}=K();return n.onMounted(()=>i({text:t.text},r=>o("result",r))),n.onUnmounted(()=>s()),(r,l)=>(n.openBlock(),n.createElementBlock("div"))}}),Ye={install(e){e.component("TgAlert",A),e.component("TgBackButton",W),e.component("TgConfirm",T),e.component("TgMainButton",C),e.component("TgPopup",h),e.component("TgScanQr",se)}};a.Alert=A,a.BackButton=W,a.Confirm=T,a.MainButton=C,a.Popup=h,a.ScanQr=se,a.default=Ye,a.useWebApp=p,a.useWebAppBackButton=E,a.useWebAppClipboard=Be,a.useWebAppClosingConfirmation=Ae,a.useWebAppCloudStorage=Se,a.useWebAppHapticFeedback=ye,a.useWebAppMainButton=J,a.useWebAppNavigation=Re,a.useWebAppPopup=b,a.useWebAppQrScanner=K,a.useWebAppRequests=Oe,a.useWebAppSendData=ze,a.useWebAppSettingsButton=Je,a.useWebAppTheme=Ke,a.useWebAppViewport=Xe,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
